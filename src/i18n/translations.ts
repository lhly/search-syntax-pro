import type { Language } from '@/types'

const translations: Record<Language, Record<string, string>> = {
  'zh-CN': {
    'common.languages.zh-CN': '简体中文',
    'common.languages.en-US': 'English',
    'common.searchEngines.baidu': '百度',
    'common.searchEngines.google': '谷歌',
    'common.searchEngines.bing': '必应',
    'common.fileTypes.pdf': 'PDF文档',
    'common.fileTypes.doc': 'Word文档',
    'common.fileTypes.docx': 'Word文档',
    'common.fileTypes.xls': 'Excel表格',
    'common.fileTypes.xlsx': 'Excel表格',
    'common.fileTypes.ppt': 'PPT演示文稿',
    'common.fileTypes.pptx': 'PPT演示文稿',
    'common.fileTypes.txt': '文本文件',
    'common.fileTypes.zip': '压缩文件',
    'common.fileTypes.rar': '压缩文件',
    'common.fileTypes.jpg': '图片文件',
    'common.fileTypes.png': '图片文件',
    'common.fileTypes.gif': '图片文件',
    'copyButton.tooltipCopy': '复制',
    'copyButton.tooltipCopied': '已复制!',
    'copyButton.copyError': '复制失败',
    'popup.headerTitle': '搜索语法大师',
    'popup.footer.currentEngine': '当前引擎: {engine}',
    'popup.settingsButtonTitle': '设置',
    'searchForm.keywordLabel': '搜索关键词',
    'searchForm.keywordPlaceholder': '输入要搜索的关键词...',
    'searchForm.engineLabel': '搜索引擎',
    'searchForm.advancedToggle': '高级搜索选项',
    'searchForm.siteLabel': '网站内搜索 (site:)',
    'searchForm.sitePlaceholder': '例如: example.com 或 wikipedia.org',
    'searchForm.siteDescription': '在指定网站内搜索内容',
    'searchForm.fileTypeLabel': '文件类型 (filetype:)',
    'searchForm.fileTypeAny': '不限文件类型',
    'searchForm.fileTypeDescription': '搜索特定格式的文件',
    'searchForm.exactLabel': '精确匹配 (" ")',
    'searchForm.exactPlaceholder': '要精确匹配的短语',
    'searchForm.exactDescription': '完全匹配输入的短语',
    'queryPreview.title': '生成的搜索查询',
    'queryPreview.executeButton': '执行搜索',
    'queryPreview.copyTooltip': '复制查询',
    'searchHistory.title': '搜索历史',
    'searchHistory.clearButton': '清除',
    'searchHistory.clearTooltip': '清除历史记录',
    'searchHistory.emptyKeyword': '(空关键词)',
    'searchHistory.emptyState': '暂无搜索历史',
    'searchHistory.summary': '显示最近10条记录，共{count}条',
    'searchHistory.unknownTime': '未知时间',
    'options.header.title': '搜索语法大师 - 设置',
    'options.header.subtitle': '设置和配置',
    'options.sections.basic': '基本设置',
    'options.sections.features': '功能设置',
    'options.sections.data': '数据管理',
    'options.fields.defaultEngine.label': '默认搜索引擎',
    'options.fields.language.label': '界面语言',
    'options.fields.theme.label': '主题设置',
    'options.fields.theme.auto': '跟随系统',
    'options.fields.theme.light': '浅色主题',
    'options.fields.theme.dark': '深色主题',
    'options.fields.enableHistory.label': '启用搜索历史',
    'options.fields.enableHistory.description': '保存搜索记录以便后续查看和重用',
    'options.fields.autoOpen.label': '在新标签页打开搜索结果',
    'options.fields.autoOpen.description': '开启时在新标签页打开搜索结果，关闭时在当前标签页打开',
    'options.fields.historyLimit.label': '历史记录限制',
    'options.fields.historyLimit.description': '最多保存的历史记录数量（建议不超过1000条）',
    'options.actions.export': '导出数据',
    'options.actions.import': '导入数据',
    'options.actions.clearAll': '清除所有数据',
    'options.actions.reset': '重置默认设置',
    'options.actions.cancel': '取消',
    'options.actions.save': '保存设置',
    'options.actions.saving': '保存中...',
    'options.messages.saveSuccess': '设置已保存',
    'options.messages.saveFailure': '保存失败',
    'options.messages.resetSuccess': '设置已重置为默认值并自动保存',
    'options.messages.resetFailure': '重置设置失败',
    'options.status.loadError': '加载设置失败',
    'options.confirm.reset': '确定要重置所有设置吗？\n\n这将恢复默认配置，但会保留您的搜索历史记录。\n操作将立即生效并自动保存。',
    'options.confirm.clearAll': '确定要清除所有数据吗？这将删除搜索历史、设置等所有信息，且无法恢复。',
    'options.confirm.clearAllSecond': '请再次确认：此操作不可撤销！',
    'options.alert.importSuccess': '数据导入成功！页面将重新加载。',
    'options.alert.importFailure': '导入失败: {error}',
    'options.alert.importInvalid': '无效的备份文件格式',
    'options.alert.unknownError': '未知错误',
    'options.alert.clearSuccess': '所有数据已清除！页面将重新加载。',
    'options.footer.title': '关于',
    'options.footer.version': '版本: {version}',
    'options.footer.author': '作者: {author}',
    'options.footer.homepage': '项目主页'
  },
  'en-US': {
    'common.languages.zh-CN': 'Simplified Chinese',
    'common.languages.en-US': 'English',
    'common.searchEngines.baidu': 'Baidu',
    'common.searchEngines.google': 'Google',
    'common.searchEngines.bing': 'Bing',
    'common.fileTypes.pdf': 'PDF Document',
    'common.fileTypes.doc': 'Word Document',
    'common.fileTypes.docx': 'Word Document',
    'common.fileTypes.xls': 'Excel Spreadsheet',
    'common.fileTypes.xlsx': 'Excel Spreadsheet',
    'common.fileTypes.ppt': 'PowerPoint Presentation',
    'common.fileTypes.pptx': 'PowerPoint Presentation',
    'common.fileTypes.txt': 'Text File',
    'common.fileTypes.zip': 'Compressed Archive',
    'common.fileTypes.rar': 'Compressed Archive',
    'common.fileTypes.jpg': 'Image File',
    'common.fileTypes.png': 'Image File',
    'common.fileTypes.gif': 'Image File',
    'copyButton.tooltipCopy': 'Copy',
    'copyButton.tooltipCopied': 'Copied!',
    'copyButton.copyError': 'Copy failed',
    'popup.headerTitle': 'SearchSyntax Pro',
    'popup.footer.currentEngine': 'Current engine: {engine}',
    'popup.settingsButtonTitle': 'Settings',
    'searchForm.keywordLabel': 'Search keywords',
    'searchForm.keywordPlaceholder': 'Enter the keywords you want to search...',
    'searchForm.engineLabel': 'Search engine',
    'searchForm.advancedToggle': 'Advanced search options',
    'searchForm.siteLabel': 'Site search (site:)',
    'searchForm.sitePlaceholder': 'e.g. example.com or wikipedia.org',
    'searchForm.siteDescription': 'Search within the specified website',
    'searchForm.fileTypeLabel': 'File type (filetype:)',
    'searchForm.fileTypeAny': 'Any file type',
    'searchForm.fileTypeDescription': 'Find files with a specific format',
    'searchForm.exactLabel': 'Exact match (" ")',
    'searchForm.exactPlaceholder': 'Phrase to match exactly',
    'searchForm.exactDescription': 'Only results containing the exact phrase',
    'queryPreview.title': 'Generated search query',
    'queryPreview.executeButton': 'Run search',
    'queryPreview.copyTooltip': 'Copy query',
    'searchHistory.title': 'Search history',
    'searchHistory.clearButton': 'Clear',
    'searchHistory.clearTooltip': 'Clear history',
    'searchHistory.emptyKeyword': '(Empty keyword)',
    'searchHistory.emptyState': 'No search history yet',
    'searchHistory.summary': 'Showing the latest 10 records, {count} total',
    'searchHistory.unknownTime': 'Unknown time',
    'options.header.title': 'SearchSyntax Pro - Settings',
    'options.header.subtitle': 'Settings & configuration',
    'options.sections.basic': 'Basic settings',
    'options.sections.features': 'Feature settings',
    'options.sections.data': 'Data management',
    'options.fields.defaultEngine.label': 'Default search engine',
    'options.fields.language.label': 'Interface language',
    'options.fields.theme.label': 'Theme',
    'options.fields.theme.auto': 'Follow system',
    'options.fields.theme.light': 'Light theme',
    'options.fields.theme.dark': 'Dark theme',
    'options.fields.enableHistory.label': 'Enable search history',
    'options.fields.enableHistory.description': 'Keep recent searches for quick access.',
    'options.fields.autoOpen.label': 'Open search results in new tab',
    'options.fields.autoOpen.description': 'When enabled, opens results in a new tab; when disabled, opens in current tab',
    'options.fields.historyLimit.label': 'History limit',
    'options.fields.historyLimit.description': 'Maximum number of saved history entries (recommended ≤ 1000).',
    'options.actions.export': 'Export data',
    'options.actions.import': 'Import data',
    'options.actions.clearAll': 'Clear all data',
    'options.actions.reset': 'Reset to defaults',
    'options.actions.cancel': 'Cancel',
    'options.actions.save': 'Save settings',
    'options.actions.saving': 'Saving...',
    'options.messages.saveSuccess': 'Settings saved',
    'options.messages.saveFailure': 'Failed to save settings',
    'options.messages.resetSuccess': 'Settings have been reset to defaults and automatically saved',
    'options.messages.resetFailure': 'Failed to reset settings',
    'options.status.loadError': 'Failed to load settings',
    'options.confirm.reset': 'Reset all settings?\n\nThis will restore default configuration but keep your search history.\nChanges will take effect immediately and be saved automatically.',
    'options.confirm.clearAll': 'Are you sure you want to clear all data? This will delete history, settings, and cannot be undone.',
    'options.confirm.clearAllSecond': 'Please confirm again: this action cannot be undone!',
    'options.alert.importSuccess': 'Data imported successfully! The page will reload.',
    'options.alert.importFailure': 'Import failed: {error}',
    'options.alert.importInvalid': 'Invalid backup file format',
    'options.alert.unknownError': 'Unknown error',
    'options.alert.clearSuccess': 'All data cleared! The page will reload.',
    'options.footer.title': 'About',
    'options.footer.version': 'Version: {version}',
    'options.footer.author': 'Author: {author}',
    'options.footer.homepage': 'Project home'
  }
}

const DEFAULT_LANGUAGE: Language = 'zh-CN'

const variablePattern = /\{(\w+)\}/g

export function translate(
  language: Language,
  key: string,
  variables?: Record<string, string | number>,
  fallback?: string
): string {
  const langTable = translations[language] ?? translations[DEFAULT_LANGUAGE]
  let template =
    langTable[key] ??
    translations[DEFAULT_LANGUAGE][key] ??
    translations['en-US'][key] ??
    fallback ??
    key

  if (!variables) {
    return template
  }

  return template.replace(variablePattern, (_, varName: string) => {
    const value = variables[varName]
    return value !== undefined ? String(value) : `{${varName}}`
  })
}

export { translations }
