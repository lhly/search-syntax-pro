<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é«˜çº§æœç´¢è¯­æ³•æµ‹è¯•</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        h1 {
            color: #333;
            border-bottom: 3px solid #4CAF50;
            padding-bottom: 10px;
        }
        .test-section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .test-case {
            margin: 15px 0;
            padding: 15px;
            background: #f9f9f9;
            border-left: 4px solid #2196F3;
            border-radius: 4px;
        }
        .test-title {
            font-weight: bold;
            color: #2196F3;
            margin-bottom: 10px;
        }
        .test-params {
            background: #fff;
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
        }
        .test-result {
            margin-top: 10px;
            padding: 10px;
            background: #e8f5e9;
            border-radius: 4px;
            word-break: break-all;
        }
        .engine-badge {
            display: inline-block;
            padding: 3px 8px;
            margin-right: 5px;
            border-radius: 3px;
            font-size: 11px;
            font-weight: bold;
        }
        .baidu { background: #4285f4; color: white; }
        .google { background: #ea4335; color: white; }
        .bing { background: #008272; color: white; }
        .success {
            color: #4CAF50;
            font-weight: bold;
        }
        .status {
            margin: 20px 0;
            padding: 15px;
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            border-radius: 4px;
        }
        button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 10px 5px;
            font-size: 14px;
        }
        button:hover {
            background: #45a049;
        }
    </style>
</head>
<body>
    <h1>ğŸ” SearchSyntax Pro - é«˜çº§è¯­æ³•æµ‹è¯•</h1>

    <div class="status">
        <strong>æµ‹è¯•çŠ¶æ€:</strong> <span id="testStatus">å‡†å¤‡å°±ç»ª</span>
    </div>

    <button onclick="runAllTests()">è¿è¡Œæ‰€æœ‰æµ‹è¯•</button>
    <button onclick="clearResults()">æ¸…é™¤ç»“æœ</button>

    <div id="testResults"></div>

    <script type="module">
        import { BaiduAdapter } from '../src/services/adapters/baidu.ts';
        import { GoogleAdapter } from '../src/services/adapters/google.ts';
        import { BingAdapter } from '../src/services/adapters/bing.ts';

        window.BaiduAdapter = BaiduAdapter;
        window.GoogleAdapter = GoogleAdapter;
        window.BingAdapter = BingAdapter;

        const testCases = [
            {
                name: 'åŸºç¡€è¯­æ³•ç»„åˆæµ‹è¯•',
                description: 'æµ‹è¯• site + filetype + exact',
                params: {
                    keyword: 'React',
                    engine: 'baidu',
                    site: 'github.com',
                    fileType: 'pdf',
                    exactMatch: 'React Hooks'
                }
            },
            {
                name: 'intitle æ ‡é¢˜æœç´¢',
                description: 'æµ‹è¯•æ ‡é¢˜æœç´¢åŠŸèƒ½',
                params: {
                    keyword: 'JavaScript',
                    engine: 'google',
                    inTitle: 'tutorial'
                }
            },
            {
                name: 'inurl URLæœç´¢',
                description: 'æµ‹è¯•URLæœç´¢åŠŸèƒ½',
                params: {
                    keyword: 'Python',
                    engine: 'baidu',
                    inUrl: 'docs'
                }
            },
            {
                name: 'æ’é™¤å…³é”®è¯æµ‹è¯•',
                description: 'æµ‹è¯•è´Ÿå·æ’é™¤åŠŸèƒ½',
                params: {
                    keyword: 'æ‰‹æœº',
                    engine: 'bing',
                    excludeWords: ['äºŒæ‰‹', 'å¹¿å‘Š', 'åŸ¹è®­']
                }
            },
            {
                name: 'ORé€»è¾‘æµ‹è¯•',
                description: 'æµ‹è¯•ORé€»è¾‘è¿ç®—',
                params: {
                    keyword: 'ç¼–ç¨‹',
                    engine: 'google',
                    orKeywords: ['JavaScript', 'Python', 'Java']
                }
            },
            {
                name: 'intext/inbody æ­£æ–‡æœç´¢',
                description: 'æµ‹è¯•æ­£æ–‡æœç´¢(ç™¾åº¦/Googleç”¨intext, Bingç”¨inbody)',
                params: {
                    keyword: 'API',
                    engine: 'baidu',
                    inText: 'æ¥å£æ–‡æ¡£'
                }
            },
            {
                name: 'æ•°å­—èŒƒå›´æµ‹è¯•',
                description: 'æµ‹è¯•æ•°å­—èŒƒå›´è¯­æ³•',
                params: {
                    keyword: 'ç¬”è®°æœ¬',
                    engine: 'google',
                    numberRange: { min: 5000, max: 10000 }
                }
            },
            {
                name: 'é€šé…ç¬¦æµ‹è¯•',
                description: 'æµ‹è¯•æ˜Ÿå·é€šé…ç¬¦',
                params: {
                    keyword: '',
                    engine: 'baidu',
                    wildcardQuery: 'React is * framework'
                }
            },
            {
                name: 'allintitle æ‰€æœ‰å…³é”®è¯åœ¨æ ‡é¢˜',
                description: 'æµ‹è¯•æ‰€æœ‰å…³é”®è¯éƒ½åœ¨æ ‡é¢˜ä¸­',
                params: {
                    keyword: '',
                    engine: 'google',
                    allInTitle: 'Python æœºå™¨å­¦ä¹  æ•™ç¨‹'
                }
            },
            {
                name: 'related ç›¸å…³ç½‘ç«™ (Google/Bing)',
                description: 'æµ‹è¯•ç›¸å…³ç½‘ç«™åŠŸèƒ½',
                params: {
                    keyword: '',
                    engine: 'google',
                    relatedSite: 'github.com'
                }
            },
            {
                name: 'cache ç½‘é¡µç¼“å­˜ (ç™¾åº¦/Google)',
                description: 'æµ‹è¯•ç½‘é¡µç¼“å­˜åŠŸèƒ½',
                params: {
                    keyword: '',
                    engine: 'google',
                    cacheSite: 'https://www.example.com'
                }
            },
            {
                name: 'å¤æ‚ç»„åˆæµ‹è¯•',
                description: 'æµ‹è¯•å¤šä¸ªé«˜çº§è¯­æ³•ç»„åˆ',
                params: {
                    keyword: 'AI',
                    engine: 'google',
                    exactMatch: 'äººå·¥æ™ºèƒ½',
                    site: 'edu.cn',
                    inTitle: 'è®ºæ–‡',
                    excludeWords: ['åŸ¹è®­'],
                    dateRange: { from: '2024-01-01', to: '2024-12-31' }
                }
            }
        ];

        function runAllTests() {
            const resultsDiv = document.getElementById('testResults');
            const statusDiv = document.getElementById('testStatus');
            resultsDiv.innerHTML = '';
            statusDiv.textContent = 'æµ‹è¯•è¿è¡Œä¸­...';

            const adapters = {
                baidu: new window.BaiduAdapter(),
                google: new window.GoogleAdapter(),
                bing: new window.BingAdapter()
            };

            testCases.forEach((testCase, index) => {
                const section = document.createElement('div');
                section.className = 'test-section';

                const title = document.createElement('h3');
                title.textContent = `æµ‹è¯• ${index + 1}: ${testCase.name}`;
                section.appendChild(title);

                const desc = document.createElement('div');
                desc.className = 'test-case';
                desc.innerHTML = `<div class="test-title">ğŸ“‹ ${testCase.description}</div>`;

                const paramsDiv = document.createElement('div');
                paramsDiv.className = 'test-params';
                paramsDiv.textContent = JSON.stringify(testCase.params, null, 2);
                desc.appendChild(paramsDiv);

                // æµ‹è¯•æ‰€æœ‰å¼•æ“
                ['baidu', 'google', 'bing'].forEach(engineName => {
                    const params = { ...testCase.params, engine: engineName };
                    const adapter = adapters[engineName];

                    try {
                        const query = adapter.buildQuery(params);
                        const validation = adapter.validateParams(params);

                        const resultDiv = document.createElement('div');
                        resultDiv.className = 'test-result';
                        resultDiv.innerHTML = `
                            <span class="engine-badge ${engineName}">${adapter.getName()}</span>
                            <strong>ç”ŸæˆURL:</strong><br>
                            <a href="${query}" target="_blank">${query}</a><br>
                            <strong>éªŒè¯çŠ¶æ€:</strong> ${validation.isValid ? '<span class="success">âœ“ é€šè¿‡</span>' : 'âœ— å¤±è´¥'}<br>
                            ${validation.errors.length > 0 ? `<strong>é”™è¯¯:</strong> ${validation.errors.join(', ')}<br>` : ''}
                            ${validation.warnings.length > 0 ? `<strong>è­¦å‘Š:</strong> ${validation.warnings.join(', ')}` : ''}
                        `;
                        desc.appendChild(resultDiv);
                    } catch (error) {
                        const errorDiv = document.createElement('div');
                        errorDiv.className = 'test-result';
                        errorDiv.style.background = '#ffebee';
                        errorDiv.innerHTML = `
                            <span class="engine-badge ${engineName}">${engineName}</span>
                            <strong>é”™è¯¯:</strong> ${error.message}
                        `;
                        desc.appendChild(errorDiv);
                    }
                });

                section.appendChild(desc);
                resultsDiv.appendChild(section);
            });

            statusDiv.innerHTML = '<span class="success">âœ“ æµ‹è¯•å®Œæˆ!</span>';
        }

        function clearResults() {
            document.getElementById('testResults').innerHTML = '';
            document.getElementById('testStatus').textContent = 'å‡†å¤‡å°±ç»ª';
        }

        window.runAllTests = runAllTests;
        window.clearResults = clearResults;

        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨è¿è¡Œæµ‹è¯•
        window.addEventListener('load', () => {
            setTimeout(runAllTests, 500);
        });
    </script>
</body>
</html>
